<%
const name = locals.name || {};
const elements = [];

if (name.country) {
  const countries = JSON.parse(include('../../../address/example/data/countries-select-options.json.ejs', { countries: { minimal: true }}));
  const country = {
    type: 'select',
    data: {
      label: getText('label.country', 'address'),
      placeholder: getText('option.placeholder', 'select'),
      name: 'country',
      options: countries
    }
  };
  elements.push(country);
}

const lastname = {
  type: 'input',
  data: {
    id: uniqueId('input-family-name'),
    label: getText('label.family', 'name'),
    name: 'family-name'
  }
};
elements.push(lastname);


if (name.married === true) {
  const married = {
    type: 'input',
    data: {
      id: uniqueId('input-married-name'),
      label: getText('label.married', 'name'),
      hint: getText('hint.married', 'name'),
      name: 'married-name'
    }
  };
  elements.push(married);
}

const firstnameId = uniqueId('input-firstname');

const firstname = {
  type: 'input',
  data: {
    id: firstnameId,
    label: getText('label.given', 'name'),
    name: 'given-name'
  }
};

const button = {
  type: 'button',
  data: {
    label: getText('label.add-firstname', 'name'),
    kind: 3,
    size: 'sm',
    attributes: {
      onclick: include('js/add-firstname.js', { id: firstnameId }),
      type: 'button'
    }
  }
};

if (name.checkbox) {
  const firstnameElements = [];
  firstnameElements.push(firstname);
  if (name.button) firstnameElements.push(button);

  const fieldsetId = uniqueId('firstname-fieldset');

  const fieldset = {
    type: 'fieldset',
    data: {
      id: fieldsetId,
      elements: firstnameElements,
      disabled: name.disabled
    }
  };

  elements.push(fieldset);

  if (name.checkbox) {
    const checkbox = {
      type: 'checkbox',
      data: {
        id: uniqueId('checkbox-name'),
        label: getText('label.no-firstname', 'name'),
        name: 'firstname-disabled',
        checked: name.checked || false,
        size: 'sm',
        attributes: {
          onclick: include('js/toggle-disable.js', { id: fieldsetId })
        }
      }
    };
    elements.push(checkbox);
  }

} else {
  elements.push(firstname);
  if (name.button) elements.push(button);
}

const data = {
  id: name.id || uniqueId('name-default'),
  label: name.label || getText('sample.default', 'name'),
  elements: elements
}
%>

<%- JSON.stringify(data); %>
