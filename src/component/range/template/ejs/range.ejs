<%#
# paramètres range

* range.id (string, required) : id du curseur

* range.size (string, optional) : taille du curseur (valeur : 'sm')

* range.name (string, required) : attribut 'name' de l'input

* range.label (string, required) : texte du label

* range.hint (string, optional) : texte de description sous le label

* range.labelAttrs (object, optional) : Pour passer des attributs au label

* range.labelClasses (array, optional) : Pour passer des classes au label

* range.attributesInput (array, optional) : Pour passer des attributs au input

* range.min (number, required) : valeur minimale du curseur

* range.max (number, required) : valeur maximale du curseur

* range.value (number, optional) : valeur initiale du curseur

* range.step (number, optional) : pas du curseur

* range.prefix (string, optional) : texte avant la valeur du curseur

* range.suffix (string, optional) : texte après la valeur du curseur

* range.type (string, optional) : type de curseur (valeur : ['double', 'step'])

* range.indicators (boolean, optionnal): Pour afficher les valeurs min et max sous le curseur [default: true]

* range.error (string, optional) : ajoute un texte d'erreur

* range.valid (string, optional) : ajoute un texte de succès

* range.multiple (boolean, optional) : Active la selection multiple de fichiers [defaut: false]

* range.disabled (boolean, optional) : Permet de désactiver le champ [defaut: false]

* range.groupAttributes (object, optional) : Pour passer des attributs au groupe

%>

<% eval(include('../../../../core/index.ejs')); %>
<% eval(include('../../../form/template/ejs/message/builder.js.ejs')); %>
<%
const range = locals.range || {};
const groupAttributes = range.attributes || {};
const classes = [prefix + '-range'];
const groupClasses = [prefix + '-range-group'];
const attributesInput = range.attributesInput || [];
const labelAttrs = range.labelAttrs || {};
const labelClass = range.labelClasses || [];
groupAttributes.id = range.groupId || uniqueId('range-group');
if (range.size) groupClasses.push(`${prefix}-range-group--${range.size}`);
if (range.min) attributesInput.min = range.min;
if (range.max) attributesInput.max = range.max;
if (range.value || range.valueA) attributesInput.value = range.value || range.valueA;
if (range.step) attributesInput.step = range.step;
if (range.prefix) groupAttributes[`data-${prefix}-prefix`] = range.prefix;
if (range.suffix) groupAttributes[`data-${prefix}-suffix`] = range.suffix;
if (range.type) groupClasses.push(`${prefix}-range-group--${range.type}`);
if (range.indicators === false) groupClasses.push(`${prefix}-range-group--no-indicators`);

const attributesInputMax = {
  min: range.min,
  max: range.max,
  step: range.step,
  value: range.valueB,
}

const builder = new MessageBuilder(range.id);
if (range.valid) {
  groupClasses.push(`${prefix}-range-group--valid`);
  builder.addValid(range.valid);
}
if (range.error) {
  groupClasses.push(`${prefix}-range-group--error`);
  builder.addError(range.error);
}
if (range.disabled) {
  groupClasses.push(`${prefix}-range-group--disabled`);
  attributesInput['disabled'] = '';
  attributesInputMax['disabled'] = '';
}
if (builder.describedby.length > 0) {
  attributesInput['aria-describedby'] = builder.describedby.join(' ');
  attributesInputMax['aria-describedby'] = builder.describedby.join(' ');
}
%>

<div <%- includeClasses(groupClasses); %> <%- includeAttrs(groupAttributes); %>>
  <%- include('../../../form/template/ejs/label', {label : {label: range.label, hint: range.hint, for: range.id, attributes: labelAttrs}}); %>
  <output></output>

  <% if (range.type === 'double') { %>
    <input <%- includeClasses(classes); %> <%- includeAttrs(attributesInput); %> type="range" id="<%= range.id %>-min" name="<%= range.name %>-min">
    <input <%- includeClasses(classes); %> <%- includeAttrs(attributesInputMax); %> type="range" id="<%= range.id %>-max" name="<%= range.name %>-max">
  <% } else { %>
    <input <%- includeClasses(classes); %> <%- includeAttrs(attributesInput); %> type="range" id="<%= range.id %>" name="<%= range.name %>">
  <% } %>


  <%- include('../../../form/template/ejs/message/messages-group', { messagesGroup: builder.messagesGroup }); %>
</div>
