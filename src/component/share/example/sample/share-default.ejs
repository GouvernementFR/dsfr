
<%
let share = locals.share || {};
let data = {};

/**
 * Fonction pour générer un objet shareLink
 **/
function buildShareButton(type, label, href, width, height, disabled, comments) {
  const title = `${label} - ${disabled ? 'désactivé' : 'nouvelle fenêtre'}`;
  return {
    name: name,
    tag: 'a',
    classes: [`${prefix}-btn--${modifier}`],
    label: label,
    comments: comments,
    disabled: disabled,
    attributes: {
      title: title,
      href: href,
      target: '_blank',
      rel: 'noopener',
      onclick: `window.open(this.href,'${label}','toolbar=no,location=yes,status=no,menubar=no,scrollbars=yes,resizable=yes,width=${width},height=${height}'); event.preventDefault();`
    }
  }
}

data.share = {
  title: 'Partager la page',
  text: 'Veuillez <a href=' + contentPlaceholder("url page autorisation cookies") + '>autoriser le dépôt de cookies</a> pour partager sur Facebook, Twitter et LinkedIn.',
  disabled: share.disabled === true,
  buttons: [
    {
      type: 'facebook',
      label: 'Partager sur Facebook',
      url: `https://www.facebook.com/sharer.php?u=${contentPlaceholder('url de la page')}`,
      width: 600,
      height: 450
    },
    {
      type: 'twitter',
      label: 'Partager sur Twitter',
      url: `https://twitter.com/intent/tweet?url=${contentPlaceholder('url de la page')}&text=${contentPlaceholder('titre ou texte descriptif de la page')}&via=${contentPlaceholder('via')}&hashtags=${contentPlaceholder('hashtags')}`,
      width: 600,
      height: 420,
      comments: !share.disabled ? 'Les paramètres de la reqûete doivent être URI-encodés (ex: encodeURIComponent() en js)': undefined
    },
    {
      type: 'facebook',
      label: 'Partager sur LinkedIn',
      url: `https://www.linkedin.com/shareArticle?url=${contentPlaceholder('url de la page')}&title=${contentPlaceholder('titre ou texte descriptif de la page')}`,
      width: 550,
      height: 550
    },
    {
      type: 'mail',
      label: 'Partager par email',
      url: `mailto:?subject=${contentPlaceholder('objet du mail')}&body=${contentPlaceholder('titre ou texte descriptif de la page')} ${contentPlaceholder('url de la page')}`
    },
    {
      type: 'copy',
      label: 'Copier dans le presse-papier',
      onclick: `navigator.clipboard.writeText(window.location);alert('Adresse copiée dans le presse papier.');` // @TODO: ajouter un polyfill pour IE11
    }
  ]
} %>


<%- include('../../template/ejs/share', data); %>
