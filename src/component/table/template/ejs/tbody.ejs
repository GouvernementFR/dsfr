<% eval(include('../../../../core/index.ejs'));

const table = tbody.table || {};
const index = tbody.index || 0;

const classes = table.classes || [];
if (table.bodies && table.bodies[index].collapse) classes.push(`${prefix}-collapse`)
const attributes = table.attributes || {};
attributes.id = table.id + '-tbody-' + index;
%>

<tbody <%- includeClasses(classes) %> <%- includeAttrs(attributes) %>>
    <% if (table.tbodies && table.tbodies[index]) { %>
        <% for (let row = 0; row < table.tbodies[index].length; row++) { %>
            <%
                const rowClasses = [];
                if (table.rows && table.rows[row] && table.rows[row].collapse) rowClasses.push(prefix + '-collapse');

                const rowAttributes = {};
                rowAttributes.id = `${table.id}-row-key-${row + 1}`;
                rowAttributes['data-row-key'] = row + 1;
            %>
            <tr <%- includeClasses(rowClasses) %> <%- includeAttrs(rowAttributes) %>>
                <% if (table.tbodies[index].length) { %>
                    <% for (let col = 0; col < table.tbodies[index][row].length; col++) { %>
                        <%
                            const colTag = table.tbodies[index][row][col].tag || 'td';
                            const colClasses = table.tbodies[index][row][col].classes || [];
                            const colAttributes = table.tbodies[index][row][col].attributes || {};
                        %>
                        <<%- colTag %> <%- includeClasses(colClasses) %> <%- includeAttrs(colAttributes) %>>
                            <%- table.tbodies[index][row][col].content %>
                        </<%- colTag %>>
                    <% } %>
                <% } %>
            </tr>
        <% } %>
    <% } %>
</tbody>
