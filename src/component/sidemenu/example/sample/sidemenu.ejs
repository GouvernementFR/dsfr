<%
let sidemenu = locals.sidemenu || {};
const models = [ 'MALMMLMMLM', 'LMMLLLL', 'LLLLLL' ];
const models2 = ['MALMMLMMLM', 'LMALLL', 'LLLL'];

function link(level, active) {
  return {
    type: 'link',
    active: active === true,
    label: 'Accès direct' + (level > 1 ? ' niveau ' + level: '')
  }
}

function items(level, active) {
  const items = [];
  let model = models[level];
  (active===true) ? model = models2[level] : models[level];

  for (let i = 0; i < model.length; i++) switch(model.charAt(i)) {
    case 'L':
      items.push(link(level + 1, active && i === 1));
      break;

    case 'M':
      items.push(menu(level + 1));
      break;

    case 'A':
      items.push(menu(level + 1, true));
      break;
  }
  return items;
}

function menu(level, active) {
  return {
    type: 'menu',
    active: active === true,
    label: active === true ? 'Entrée menu active' : 'Niveau ' + level,
    collapseId: uniqueId('sidemenu'),
    items: items(level, active)
  }
}


let data = {
    items: items(0),
    modifier: sidemenu.modifier,
    collapseId: uniqueId('sidemenu')
}

%>

<%- include('../../template/ejs/sidemenu', {sidemenu: data}); %>
